<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quickstart &#8212; GRANAD  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4848ba22" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css?v=a5b9c134" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Units" href="units.html" />
    <link rel="prev" title="Setup" href="setup.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="units.html" title="Units"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setup"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GRANAD  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Quickstart</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">¶</a></h1>
<p>GRANAD offers</p>
<ol class="arabic simple">
<li><p>Calculations of independent-particle (IP) quantities based on parametric tight-binding (TB) Hamiltonians.</p></li>
<li><p>Many-body calculations of e.g. absorption spectra based on the time-domain formalism presented in <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/nn204780e">https://pubs.acs.org/doi/abs/10.1021/nn204780e</a>.</p></li>
</ol>
<p>The following is an illustration of GRANAD’s core capabilities.</p>
<section id="a-typical-simulation">
<h2>A typical simulation<a class="headerlink" href="#a-typical-simulation" title="Link to this heading">¶</a></h2>
<p>A typical GRANAD simulation consists of two steps:</p>
<ol class="arabic simple">
<li><p>Describing a stacked nanomaterial with the help of the class <a class="reference internal" href="granad.html#granad.StackBuilder" title="granad.StackBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.StackBuilder</span></code></a>.</p></li>
<li><p>Extracting physical quantities from the nanomaterial with the help of the class <a class="reference internal" href="granad.html#granad.Stack" title="granad.Stack"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Stack</span></code></a>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GRANAD is built on top of <a class="reference external" href="https://jax.readthedocs.io/en/latest/">JAX</a>.
For this reason, JAX’s equivalent to numpy should be used.
In most cases, this amounts to a simple replacement of <code class="code docutils literal notranslate"><span class="pre">numpy</span></code> with <code class="code docutils literal notranslate"><span class="pre">jax.numpy</span></code>,
as in <code class="code docutils literal notranslate"><span class="pre">numpy.array([1,2,3])</span></code> and <code class="code docutils literal notranslate"><span class="pre">jax.numpy.array([1,2,3])</span></code>.</p>
</div>
<p>In the following, we detail both steps to visualize the indepdendent-particle
energy landscape and first excited state of a triangular graphene flake.</p>
<section id="building-the-stack">
<h3>Building the Stack<a class="headerlink" href="#building-the-stack" title="Link to this heading">¶</a></h3>
<p>The first simulation step mainly operates on Python primitives and is designed
to offer an easy interactive way to specify a nanomaterial.</p>
<p>We start by initializing a <a class="reference internal" href="granad.html#granad.StackBuilder" title="granad.StackBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.StackBuilder</span></code></a> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">StackBuilder</span><span class="p">()</span>
</pre></div>
</div>
<p>We want to model</p>
<ol class="arabic simple">
<li><p>a <em>triangular</em> flake of 7.4 Å (0.74 nm)</p></li>
<li><p>with an <em>armchair</em> edge type, which is</p></li>
<li><p>made from graphene, i.e. a <em>honeycomb</em> lattice with a <em>lattice constant</em> of 2.46 Å.</p></li>
</ol>
<p>GRANAD directly understands the triangle requirement. To get a triangular flake, we use the class <a class="reference internal" href="granad.html#granad.Triangle" title="granad.Triangle"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Triangle</span></code></a> like so</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Triangle</span><span class="p">(</span><span class="mf">7.4</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are more shape options in GRANAD, e.g. <a class="reference internal" href="granad.html#granad.Rectangle" title="granad.Rectangle"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Rectangle</span></code></a>. They
are used completly analogously.</p>
</div>
<p>GRANAD lets us put all these requirements together to specify a flake cut from a larger lattice via its class <a class="reference internal" href="granad.html#granad.Lattice" title="granad.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Lattice</span></code></a> as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">triangle</span><span class="p">,</span>
    <span class="n">lattice_type</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeType</span><span class="o">.</span><span class="n">HONEYCOMB</span><span class="p">,</span>
    <span class="n">lattice_edge</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeEdge</span><span class="o">.</span><span class="n">ARMCHAIR</span><span class="p">,</span>
    <span class="n">lattice_constant</span><span class="o">=</span><span class="mf">2.46</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now that we have specified the lattice, we add it to the StackBuilder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">graphene</span><span class="p">)</span>
</pre></div>
</div>
<p>GRANAD considers this as the addition of a single orbital named <code class="code docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code> located at exactly the positions we want (we consider spin-traced dynamics). We can quickly visualize the stack with the method <a class="reference internal" href="granad.html#granad.StackBuilder.show3D" title="granad.StackBuilder.show3D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.show3D()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">show3D</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/e36a2ded47ef49f73a8f29a96802eee7/stack_building.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/701be5fb08b203975d888699537b688d/stack_building.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/0c91d010dc96feb40a399361e3d10b96/stack_building.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/465c7398f13428097a30ce123a2cb91b/stack_building.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/stack_building.png" class="plot-directive" src="_images/stack_building.png" />
</figure>
<p>Now that we have built the stack, we can proceed to specify its TB-parameters.</p>
</section>
<section id="defining-parameters">
<h3>Defining parameters<a class="headerlink" href="#defining-parameters" title="Link to this heading">¶</a></h3>
<p>GRANAD knows two different couplings, which can be flexibly specified:</p>
<ol class="arabic simple">
<li><p>TB-hoppings are specified using <a class="reference internal" href="granad.html#granad.StackBuilder.set_hopping" title="granad.StackBuilder.set_hopping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.set_hopping()</span></code></a></p></li>
<li><p>Coulomb interaction matrix elements are specified using <a class="reference internal" href="granad.html#granad.StackBuilder.set_coulomb" title="granad.StackBuilder.set_coulomb"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.set_coulomb()</span></code></a>.</p></li>
</ol>
<p>The two methods work exactly analogously and have the same signature. They accept a class describing the coupling between the orbitals.</p>
<section id="coupling-class-types">
<span id="coupling-classes"></span><h4>Coupling Class Types<a class="headerlink" href="#coupling-class-types" title="Link to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p><a class="reference internal" href="granad.html#granad.DistanceCoupling" title="granad.DistanceCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.DistanceCoupling</span></code></a>: coupling as a distance-dependent function.</p></li>
<li><p><a class="reference internal" href="granad.html#granad.LatticeCoupling" title="granad.LatticeCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeCoupling</span></code></a>: coupling in a regular structure (like a graphene flake) via a list of neighbor couplings.</p></li>
<li><p><a class="reference internal" href="granad.html#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeSpotCoupling</span></code></a>: coupling between a single spot (hosting, e.g. an isolated atom) and a regular structure.</p></li>
<li><p><a class="reference internal" href="granad.html#granad.SpotCoupling" title="granad.SpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.SpotCoupling</span></code></a>: couplings in an isolated spot.</p></li>
</ol>
<p>Returning to our stack, we are just considering a single graphene flake and want to use the a nearest-neighbor hopping rate of <code class="code docutils literal notranslate"><span class="pre">-2.66</span></code> with <code class="code docutils literal notranslate"><span class="pre">0</span></code> onsite energies. Since we have a regular structure of many orbitals, we need the second class. Its constructor expects:</p>
<ul class="simple">
<li><p>The ids of the two orbitals we want to couple.</p></li>
<li><p>The lattice we have just specified.</p></li>
<li><p>A list of couplings of the form <code class="code docutils literal notranslate"><span class="pre">[onsite,</span> <span class="pre">nearest_neighbor]</span></code> (actually, this list can have arbitrarily many entries for arbitrarily many neighbor-couplings).</p></li>
</ul>
<p>In our case, this translates to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hopping_graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeCoupling</span><span class="p">(</span>
    <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">graphene</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.66</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">hopping_graphene</span><span class="p">)</span>
</pre></div>
</div>
<p>If we wanted to have a next-to-nearest-neighbor coupling of <code class="code docutils literal notranslate"><span class="pre">-1</span></code>, we would have to change the list to <code class="code docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">-2.66,</span> <span class="pre">-1]</span></code>.</p>
<p>Now, we want to set the coulomb matrix energies.
We want to set the neighbor couplings to <code class="code docutils literal notranslate"><span class="pre">[16.522,</span> <span class="pre">8.64,</span> <span class="pre">5.333]</span></code> and apply the classical
law <span class="math notranslate nohighlight">\(c(r) = 14.399 / r\)</span> for any pz-Orbital that is further away.
GRANAD offers a way to achieve this by supplying this classical function an optional parameter to <a class="reference internal" href="granad.html#granad.LatticeCoupling" title="granad.LatticeCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeCoupling</span></code></a> as follows:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to internal reasons, any coupling function <em>must return a complex number</em>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coulomb_graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeCoupling</span><span class="p">(</span>
    <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
    <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
    <span class="n">lattice</span><span class="o">=</span><span class="n">graphene</span><span class="p">,</span>
    <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mf">16.522</span><span class="p">,</span> <span class="mf">8.64</span><span class="p">,</span> <span class="mf">5.333</span><span class="p">],</span>
    <span class="n">coupling_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mf">14.399</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">coulomb_graphene</span><span class="p">)</span>
</pre></div>
</div>
<p>We have now specified all couplings and can proceed to extract physical quantities.</p>
</section>
</section>
<section id="extract-physical-quantities">
<h3>Extract physical quantities<a class="headerlink" href="#extract-physical-quantities" title="Link to this heading">¶</a></h3>
<p>Since the stack is now fully built and we want to start doing numerics,
we have no need for the <code class="code docutils literal notranslate"><span class="pre">StackBuilder</span></code> anymore.
The central numerical class in GRANAD is <a class="reference internal" href="granad.html#granad.Stack" title="granad.Stack"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Stack</span></code></a>.
A <code class="code docutils literal notranslate"><span class="pre">Stack</span></code> object is just a container. It holds arrays that correspond to the numerical description of the nanomaterial we have just specified.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The state of a stack corresponds to its 1RDM density matrix and is thus a complex array.</p>
</div>
<p>We obtain it using the method <a class="reference internal" href="granad.html#granad.StackBuilder.get_stack" title="granad.StackBuilder.get_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.get_stack()</span></code></a>.
This method allows us to set the initial IP state of the stack. By default, it
produces the ground state, but we could also decide to use, e.g. the first excited state.
Additionally, we can control the number of doping electrons in the stack,
add a diagonal term to the Hamiltonian corresponding to the influence
of a homogeneous electric field or set some internal numerical precision.
For now, we don’t need to touch on these options, but instead initialize the
stack in the ground state, without any additional terms. This means we just call the method without any arguments and store the resulting stack</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">get_stack</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Internally, a stack is just used to store data and has no mutable state. So, any changes to coupling parameters must happen at the level of the <code class="code docutils literal notranslate"><span class="pre">StackBuilder</span></code>, not the <code class="code docutils literal notranslate"><span class="pre">Stack</span></code>!</p>
</div>
<p>Visualizing IP physical quantities is now easy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualize the first &quot;excited state&quot;</span>
<span class="n">granad</span><span class="o">.</span><span class="n">show_eigenstate2D</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">show_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># visualize the energy spectrum</span>
<span class="n">granad</span><span class="o">.</span><span class="n">show_energies</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/8df09aa36b771d686aa2b9069994dff5/energies_layer.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id2">
<img alt="_images/energies_layer_00.png" class="plot-directive" src="_images/energies_layer_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/6d14f584a7e6edc9187b84050fae8001/energies_layer_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/affd884a459e69f64c3a0af9c61b8645/energies_layer_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/a9b396b0f0c55af60151858e4c7e3485/energies_layer_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<img alt="_images/energies_layer_01.png" class="plot-directive" src="_images/energies_layer_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/f8449d0d7e962799b67f08a668834176/energies_layer_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/541aa4aef9f52fe37eaafa06c904842c/energies_layer_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/907c655e7104d7fb6668902e9d31d149/energies_layer_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="dynamic-quantities">
<h2>Dynamic quantities<a class="headerlink" href="#dynamic-quantities" title="Link to this heading">¶</a></h2>
<p>We now turn to time-domain simulations. We want to calculate the absorption spectrum
of the triangular flake we just built. The absorption cross section is calculated as follows</p>
<ol class="arabic simple">
<li><p>We illuminate the flake with an electric field pulse for a specific time and record the site occupations <span class="math notranslate nohighlight">\(\rho_{ii}\)</span>, where <span class="math notranslate nohighlight">\(\rho\)</span> is the real-space density matrix.</p></li>
<li><p>The induced dipole moments are calculated at every orbital position <span class="math notranslate nohighlight">\(R_i\)</span> according to <span class="math notranslate nohighlight">\(p_i \sim R_i \rho_{ii}\)</span>.</p></li>
<li><p>We Fourier transform the dipole moments to obtain the dynamic polarizability as <span class="math notranslate nohighlight">\(\alpha(\omega) = p(\omega) / E(\omega)\)</span>.</p></li>
<li><p>Finally, we compute the absorption cross section as <span class="math notranslate nohighlight">\(\sigma(\omega) = -\omega \text{Im}[\alpha]\)</span>.</p></li>
</ol>
<section id="modelling-an-electric-field-pulse">
<h3>Modelling an Electric Field Pulse<a class="headerlink" href="#modelling-an-electric-field-pulse" title="Link to this heading">¶</a></h3>
<p>First, we need to define the illumination. GRANAD offers multiple functions for modelling electric fields. All of them are assumed to propagate in z-direction. The one for our purpose is called <a class="reference internal" href="granad.html#granad.electric_field_pulse" title="granad.electric_field_pulse"><code class="xref py py-func docutils literal notranslate"><span class="pre">granad.electric_field_pulse()</span></code></a>. As for all electric field functions, it takes in the properties of the electric field and returns a function. This function takes in a point in time and returns the corresponding electric field. We will see in detail how this works below.</p>
<p>In general, for using electric field functions, we need to know the properties of the field, i.e.</p>
<ol class="arabic simple">
<li><p>The amplitudes of its vectors components <span class="math notranslate nohighlight">\((E_x, E_y, E_z)\)</span>.</p></li>
<li><p>Its frequency <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>The location where we need it to be evaluated. In our case, we want to know the field at the position of the atoms in the stack. Fortunately, the class <a class="reference internal" href="granad.html#granad.Stack" title="granad.Stack"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Stack</span></code></a> has a corresponding attribute.</p></li>
</ol>
<p>Additionally, we are considering a pulse, so we also need to know the spectral
location of its peak and its full width at half maximum (fwhm).</p>
<p>Putting all of this together, we can obtain an electric field as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">field_func</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">electric_field_pulse</span><span class="p">(</span>
    <span class="n">amplitudes</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">stack</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">peak</span><span class="p">,</span> <span class="n">fwhm</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="absorption-spectra">
<h3>Absorption spectra<a class="headerlink" href="#absorption-spectra" title="Link to this heading">¶</a></h3>
<p>We now get to the actual simulation. First, we need to do a necessary import</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
</pre></div>
</div>
<p>This just imports JAX’s version of numpy. You can mostly use the same functions here as you would in regular numpy, just replacing <code class="code docutils literal notranslate"><span class="pre">np</span></code>, which <code class="code docutils literal notranslate"><span class="pre">jnp</span></code>.</p>
<p>For example, this is how we define the simulation duration (GRANAD’s units
are explained in <a class="reference internal" href="units.html"><span class="doc">Units</span></a>.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time_axis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The actual simulation is performed using the function <a class="reference internal" href="granad.html#granad.evolution" title="granad.evolution"><code class="xref py py-func docutils literal notranslate"><span class="pre">granad.evolution()</span></code></a>. We must supply this function with the following arguments</p>
<ol class="arabic simple">
<li><p>The stack object we just built.</p></li>
<li><p>The simulation time.</p></li>
<li><p>The electric field we just defined.</p></li>
<li><p>A damping function describing losses in our structure.</p></li>
</ol>
<p>This function returns the updated stack and an array of density matrices in real space. The dimension of this array is <span class="math notranslate nohighlight">\(N \times N \times T\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of orbitals and <span class="math notranslate nohighlight">\(T\)</span> is the number of timesteps in the simulation. This array can get very large, quickly exhausting our computational resources.</p>
<p>One strategy to overcome this problem is to chunk the simulation duration into little bits, run them one by one and save all intermediary results to disk. For the present example, we chose an easier route.</p>
<p>For the calculation of the absorption spectrum, we only need the diagonal elements of the density matrix. Conveniently, the function <a class="reference internal" href="granad.html#granad.evolution" title="granad.evolution"><code class="xref py py-func docutils literal notranslate"><span class="pre">granad.evolution()</span></code></a> takes an optional extra-argument, which is a postprocessing function. This function must return an array and is applied to all <span class="math notranslate nohighlight">\(T\)</span> density matrices we get from the simulation.</p>
<p>Only the diagonal elements are needed, so our postprocessing function should be <code class="code docutils literal notranslate"><span class="pre">jnp.diag</span></code>, resulting in an array of shape <span class="math notranslate nohighlight">\(N \times T\)</span>, drastically reducing memory consumption.</p>
<p>For the damping function, we just chose <a class="reference internal" href="granad.html#granad.evolution" title="granad.evolution"><code class="xref py py-func docutils literal notranslate"><span class="pre">granad.evolution()</span></code></a> with a damping rate of 0.1. Ultimately, this results in</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_stack</span><span class="p">,</span> <span class="n">occupations</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">evolution</span><span class="p">(</span>
    <span class="n">stack</span><span class="p">,</span>
    <span class="n">time_axis</span><span class="p">,</span>
    <span class="n">field_func</span><span class="p">,</span>
    <span class="n">granad</span><span class="o">.</span><span class="n">relaxation</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">postprocess</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span>
<span class="p">)</span>
</pre></div>
</div>
<p>After letting the simulation run for a while, we can calculate the induced dipole moment in real space</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dipole_moment</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">induced_dipole_moment</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">occupations</span><span class="p">)</span>
</pre></div>
</div>
<p>We then perform a Fourier transform (note that you have to supply a custom implementation of this function as of now)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">omega_axis</span><span class="p">,</span> <span class="n">dipole_omega</span> <span class="o">=</span> <span class="n">get_fourier_transform</span><span class="p">(</span><span class="n">time_axis</span><span class="p">,</span> <span class="n">dipole_moment</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>After Fourier transforming the x-component of the electric field as well, we can
compute the absorption cross section, and plot the result</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">omega_max</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">component</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">polarizability</span> <span class="o">=</span> <span class="n">dipole_omega</span> <span class="o">/</span> <span class="n">field_omega</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="o">-</span><span class="n">omega_axis</span><span class="p">[:</span><span class="n">omega_max</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">polarizability</span><span class="p">[:</span><span class="n">omega_max</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega_axis</span><span class="p">[:</span><span class="n">omega_max</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\hbar\omega$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma(\omega)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This results in</p>
<p>(<a class="reference download internal" download="" href="_downloads/f158137f9f28505eb5e7ff7a59fbd8d1/time_domain_simulation_loss.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/867715157e48e39bd5eee077046252c7/time_domain_simulation_loss.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/3c635a8dca4cad930f78f6af4c881f45/time_domain_simulation_loss.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/279065a0f4c389cc7787e527eecabc5d/time_domain_simulation_loss.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/time_domain_simulation_loss.png" class="plot-directive" src="_images/time_domain_simulation_loss.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output of time domain simulations can be used to calculate a variety of other quantities, such as the EPI, induced fields, and more; all of them are described in the reference.</p>
</div>
</section>
</section>
<section id="modelling-adatoms">
<h2>Modelling Adatoms<a class="headerlink" href="#modelling-adatoms" title="Link to this heading">¶</a></h2>
<p>We already know how to handle flake nanomaterials cut from a larger lattice. Now, we need to proceed how to model individual adatoms. In contrast to graphene, where we needed to model a lattice, we now need to model a single spot. This is done with the help of <a class="reference internal" href="granad.html#granad.Spot" title="granad.Spot"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Spot</span></code></a>.</p>
<p>First, we again initialize a StackBuilder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">StackBuilder</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, we define the spot we want to use. This is just a point in 3D-space. For simplicity, we use the coordinate origin</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spot</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</pre></div>
</div>
<p>We then want to model our adatom as a two-level system (TLS) at this point, containing
a low-energy orbital, called <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and high-energy orbital, called <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>.
So, we need to add two orbitals at this spot. However, we want only the <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> to be occupied, so we explicitly set the occupation of <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> to <code class="code docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">spot</span><span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">spot</span><span class="p">,</span> <span class="n">occupation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we need the couplings. Remembering the list under <a class="reference internal" href="#coupling-classes">coupling classes</a>, we use the
class <a class="reference internal" href="granad.html#granad.SpotCoupling" title="granad.SpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.SpotCoupling</span></code></a> to specify how the two orbitals in the isolated spot couple to each other.
This happens very analogously to the lattice coupling. The only difference is that, since we consider a single point in space, the coupling is described by a single number and not a list.</p>
<p>We want the two adatom levels to couple as follows:</p>
<ol class="arabic simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> should have an energy of <code class="code docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> should have an energy of <code class="code docutils literal notranslate"><span class="pre">2</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> should have a coupling energy of <code class="code docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> should have an onsite coulomb repulsion of <code class="code docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> should have an onsite coulomb repulsion of <code class="code docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> should have an onsite coulomb repulsion of <code class="code docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
</ol>
<p>The corresponding use of the <code class="code docutils literal notranslate"><span class="pre">SpotCoupling</span></code> class to achieve this is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># onsite hopping</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># onsite coulomb</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>We can now again obtain the stack, and plot the energies.</p>
<p>(<a class="reference download internal" download="" href="_downloads/8846bde3a237a373206a326f11567269/energies_adatom.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/11a75d5515a4ff3548e7492c636b4750/energies_adatom.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/4b4ceb661f1ca41625ff0ff63d80af7b/energies_adatom.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/c6013a37f573e67b96c701ae0fb86142/energies_adatom.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/energies_adatom.png" class="plot-directive" src="_images/energies_adatom.png" />
</figure>
</section>
<section id="combining-adatoms-and-layers">
<h2>Combining adatoms and layers<a class="headerlink" href="#combining-adatoms-and-layers" title="Link to this heading">¶</a></h2>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Currently, only a single two-level adatom and a single graphene layer are implemented.</p>
</div>
<p>So far, we know how to handle lattice-based and isolated systems. We can, however, also couple both of them. In this example, we want to add a TLS in the top-position of a pz-Orbital in a benzene ring. The initial setup of the benzene ring is familiar: we need a <a class="reference internal" href="granad.html#granad.StackBuilder" title="granad.StackBuilder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder()</span></code></a> object and capture the geometry of the benzene ring with a <a class="reference internal" href="granad.html#granad.Lattice" title="granad.Lattice"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.Lattice()</span></code></a> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># build stack</span>
<span class="n">sb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">StackBuilder</span><span class="p">()</span>

<span class="c1"># add graphene</span>
<span class="n">graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">Triangle</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">lattice_type</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeType</span><span class="o">.</span><span class="n">HONEYCOMB</span><span class="p">,</span>
    <span class="n">lattice_edge</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeEdge</span><span class="o">.</span><span class="n">ARMCHAIR</span><span class="p">,</span>
    <span class="n">lattice_constant</span><span class="o">=</span><span class="mf">2.46</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">graphene</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using geometry types such as <a class="reference internal" href="granad.html#granad.Triangle" title="granad.Triangle"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.Triangle</span></code></a>, the largest possible shape is chosen that matches the size requirement.</p>
</div>
<p>Inspecting with the method <a class="reference internal" href="granad.html#granad.StackBuilder.show3D" title="granad.StackBuilder.show3D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.show3D()</span></code></a>, we
see that each individual orbital is annotated with an index. We pick the 0-th pz-Orbital to place the TLS on top of.</p>
<p>(<a class="reference download internal" download="" href="_downloads/e8eb124330bf7de8ff09fa93a764b64a/single_benzene_ring.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/427b1dba55b3d63e7d5ac9d587d69c7b/single_benzene_ring.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/7bc6a800e9233adff8899983a26a0afd/single_benzene_ring.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/cf757e0ca2a4e5cb079a4eba9a48b629/single_benzene_ring.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/single_benzene_ring.png" class="plot-directive" src="_images/single_benzene_ring.png" />
</figure>
<p>Then, we use the method <a class="reference internal" href="granad.html#granad.StackBuilder.get_positions" title="granad.StackBuilder.get_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.get_positions()</span></code></a>: It returns all positions in the stack as an array. The array is of dimension <span class="math notranslate nohighlight">\(N \times 3\)</span>, where the first index corresponds to the index shown by <a class="reference internal" href="granad.html#granad.StackBuilder.show3D" title="granad.StackBuilder.show3D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.StackBuilder.show3D()</span></code></a>. We now place the TLS with a low-energy orbital called <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and a high energy orbital called <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> in the top-position in a distance in z-direction of 1 Å of the 0-th pz-Orbital. Here, we must not forget to set the (non-interacting) occupation of the higher level to 0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># add adatom in top position over the 0-th atom in benzene ring</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="n">top_position</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">spot</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">top_position</span><span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">spot</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we need to specify the couplings. For the isolated flake and TLS, this proceeds exactly analogously to the previous sections and is omitted here for brevity. The new problem, however, is to couple the two components. Looking at the possible <a class="reference internal" href="#coupling-classes">coupling classes</a> again, we see that we need to couple a lattice system with a single spot and thus need <a class="reference internal" href="granad.html#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeSpotCoupling</span></code></a>.
2
We want to couple the <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> orbital of the TLS to the benzene ring as follows:</p>
<ol class="arabic simple">
<li><p>The hopping between <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code> should be <code class="code docutils literal notranslate"><span class="pre">1</span></code> for nearest neighbours, <code class="code docutils literal notranslate"><span class="pre">0.5</span></code> for next-to-nearest neighbors and <code class="code docutils literal notranslate"><span class="pre">0</span></code> beyond.</p></li>
<li><p>The coulomb interaction between <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code> should be <code class="code docutils literal notranslate"><span class="pre">2</span></code> for nearest neighbours and the classical relation <span class="math notranslate nohighlight">\(c(r) = \frac{1}{r}\)</span> beyond. For sake of simplicity, we assume identical coupling strengths for <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>.</p></li>
</ol>
<p>The way to do this with <a class="reference internal" href="granad.html#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeSpotCoupling</span></code></a> is thus</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lattice_spot_hopping</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeSpotCoupling</span><span class="p">(</span>
    <span class="n">lattice_id</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">spot_id</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">lattice_spot_hopping</span><span class="p">)</span>
<span class="n">lattice_spot_coulomb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeSpotCoupling</span><span class="p">(</span>
    <span class="n">lattice_id</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
    <span class="n">spot_id</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">coupling_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">lattice_spot_coulomb</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The constructor arguments to <a class="reference internal" href="granad.html#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><code class="xref py py-class docutils literal notranslate"><span class="pre">granad.LatticeSpotCoupling</span></code></a> make an explicit distinction between the id of the lattice orbital and the id of the isolated orbital. Make sure not to mix up the two.</p>
</div>
<p>Of course, we now have to specify the coupling between <code class="code docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>. GRANAD will complain
if any coupling combination is not supplied. For sake of simplicity, we chose this coupling exactly as in the lower-energy case.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lattice_spot_hopping</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeSpotCoupling</span><span class="p">(</span>
    <span class="n">lattice_id</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">spot_id</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">lattice_spot_hopping</span><span class="p">)</span>
<span class="n">lattice_spot_coulomb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeSpotCoupling</span><span class="p">(</span>
    <span class="n">lattice_id</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
    <span class="n">spot_id</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">coupling_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">lattice_spot_coulomb</span><span class="p">)</span>
</pre></div>
</div>
<p>Physical quantities can be visualized as usual.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">get_stack</span><span class="p">()</span>

<span class="n">granad</span><span class="o">.</span><span class="n">show_energies</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span>
<span class="n">granad</span><span class="o">.</span><span class="n">show_eigenstate3D</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/9e224fc65448e7085e4969e92bb85906/energies_layer_adatom.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id4">
<img alt="_images/energies_layer_adatom_00.png" class="plot-directive" src="_images/energies_layer_adatom_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/96267d57bb5ef58b35830d495eb63a3f/energies_layer_adatom_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/a5c8af56a4c30b00dd975f004c343ee1/energies_layer_adatom_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/b6df8ea03b8fcf722b274547fae2b6c7/energies_layer_adatom_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<img alt="_images/energies_layer_adatom_01.png" class="plot-directive" src="_images/energies_layer_adatom_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/50136319ce13fd243d634e62ac27dd91/energies_layer_adatom_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/4340afec7cd78bedc014f17a260c1bf9/energies_layer_adatom_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/68e8accca6a73c7e3e181c387369bcc5/energies_layer_adatom_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="differentiability">
<h2>Differentiability<a class="headerlink" href="#differentiability" title="Link to this heading">¶</a></h2>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Currently, this feature is implemented, but not tested.</p>
</div>
<p>GRANAD is built on <a class="reference external" href="https://jax.readthedocs.io/en/latest/">JAX</a>. One motivation behind expressing GRANAD’s computations as pure function composition is thus given by the possibility to leverage JAX’s automatic differentiation capabilities, e.g. for parametric optimization.</p>
<p>This can serve, e.g. as a simplified way to determine the adsorption position of an adatom.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">granad</span>

<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>


<span class="k">def</span> <span class="nf">energy_gs</span><span class="p">(</span><span class="n">position</span><span class="p">):</span>

    <span class="c1"># build stack</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">StackBuilder</span><span class="p">()</span>

    <span class="c1"># add graphene</span>
    <span class="n">graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">Triangle</span><span class="p">(</span><span class="mf">7.4</span><span class="p">),</span>
        <span class="n">lattice_type</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeType</span><span class="o">.</span><span class="n">HONEYCOMB</span><span class="p">,</span>
        <span class="n">lattice_edge</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeEdge</span><span class="o">.</span><span class="n">ARMCHAIR</span><span class="p">,</span>
        <span class="n">lattice_constant</span><span class="o">=</span><span class="mf">2.46</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">graphene</span><span class="p">)</span>

    <span class="c1"># add adatom in top position over the 0-th atom in benzene ring</span>
    <span class="n">spot</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Spot</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">spot</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">spot</span><span class="p">,</span> <span class="n">occupation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># set graphene couplings</span>
    <span class="n">hopping_graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeCoupling</span><span class="p">(</span>
        <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">graphene</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.66</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">hopping_graphene</span><span class="p">)</span>

    <span class="n">coulomb_graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">LatticeCoupling</span><span class="p">(</span>
        <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
        <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
        <span class="n">lattice</span><span class="o">=</span><span class="n">graphene</span><span class="p">,</span>
        <span class="n">couplings</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">coupling_function</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">coulomb_graphene</span><span class="p">)</span>

    <span class="c1"># set adatom couplings</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">granad</span><span class="o">.</span><span class="n">SpotCoupling</span><span class="p">(</span><span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">coupling</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># set adatom and graphene coupling</span>
    <span class="n">distance_coupling_ag</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">DistanceCoupling</span><span class="p">(</span>
        <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
        <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>
        <span class="n">coupling_function</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">distance_coupling_bg</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">DistanceCoupling</span><span class="p">(</span>
        <span class="n">orbital_id1</span><span class="o">=</span><span class="s2">&quot;pz&quot;</span><span class="p">,</span>
        <span class="n">orbital_id2</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
        <span class="n">coupling_function</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">distance_coupling_ag</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_hopping</span><span class="p">(</span><span class="n">distance_coupling_bg</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">distance_coupling_ag</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_coulomb</span><span class="p">(</span><span class="n">distance_coupling_bg</span><span class="p">)</span>

    <span class="n">stack</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">get_stack</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">stack</span><span class="o">.</span><span class="n">energies</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

<span class="c1"># obtain gradient wrt to the position</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jacfwd</span><span class="p">(</span><span class="n">energy_gs</span><span class="p">)(</span><span class="n">pos</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="more-examples">
<h2>More Examples<a class="headerlink" href="#more-examples" title="Link to this heading">¶</a></h2>
<p>More examples can be found in the examples folder of the offical release.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Quickstart</a><ul>
<li><a class="reference internal" href="#a-typical-simulation">A typical simulation</a><ul>
<li><a class="reference internal" href="#building-the-stack">Building the Stack</a></li>
<li><a class="reference internal" href="#defining-parameters">Defining parameters</a><ul>
<li><a class="reference internal" href="#coupling-class-types">Coupling Class Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extract-physical-quantities">Extract physical quantities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamic-quantities">Dynamic quantities</a><ul>
<li><a class="reference internal" href="#modelling-an-electric-field-pulse">Modelling an Electric Field Pulse</a></li>
<li><a class="reference internal" href="#absorption-spectra">Absorption spectra</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelling-adatoms">Modelling Adatoms</a></li>
<li><a class="reference internal" href="#combining-adatoms-and-layers">Combining adatoms and layers</a></li>
<li><a class="reference internal" href="#differentiability">Differentiability</a></li>
<li><a class="reference internal" href="#more-examples">More Examples</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="setup.html"
                          title="previous chapter">Setup</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="units.html"
                          title="next chapter">Units</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/quickstart.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="units.html" title="Units"
             >next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setup"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GRANAD  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Quickstart</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, D.Dams, A.Ghosh, K.Słowik, J.Szczuczko.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>