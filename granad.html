<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reference &#8212; GRANAD  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4848ba22" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css?v=a5b9c134" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="About" href="about.html" />
    <link rel="prev" title="Units" href="units.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="about.html" title="About"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="units.html" title="Units"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GRANAD  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-granad">
<span id="reference"></span><h1>Reference<a class="headerlink" href="#module-granad" title="Link to this heading">¶</a></h1>
<p>GRANAD: GRAphene Nanoantennas with ADatoms</p>
<dl class="py class">
<dt class="sig sig-object py" id="granad.Chain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Chain" title="Link to this definition">¶</a></dt>
<dd><p>A chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – length of the chain</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.DistanceCoupling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">DistanceCoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_id2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_function</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.DistanceCoupling" title="Link to this definition">¶</a></dt>
<dd><p>Distance-dependent coupling.</p>
<p>For example, a model direct channel repulsion of <span class="math notranslate nohighlight">\(\frac{1}{r}\)</span> between
two orbitals identified by the strings <code class="code docutils literal notranslate"><span class="pre">&quot;X&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;Y&quot;</span></code> can be modelled
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coulomb_repulsion</span> <span class="o">=</span> <span class="n">SpotCoupling</span><span class="p">(</span>
<span class="n">orbital_id1</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">orbital_id2</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">coupling</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span> <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">r</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbital_id1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>orbital_id2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>coupling_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.12)"><em>complex</em></a><em>]</em>) – coupling function, must return a <strong>complex number</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Hexagon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Hexagon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">side_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Hexagon" title="Link to this definition">¶</a></dt>
<dd><p>A hexagon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>side_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Side length of the hexagon</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Lattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_constant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Lattice" title="Link to this definition">¶</a></dt>
<dd><p>Monoatomic lattice cut.</p>
<p>A triangular graphene lattice cut would be described as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graphene</span> <span class="o">=</span> <span class="n">granad</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span>
           <span class="n">shape</span><span class="o">=</span><span class="n">triangle</span><span class="p">,</span>
           <span class="n">lattice_edge</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeEdge</span><span class="o">.</span><span class="n">ARMCHAIR</span><span class="p">,</span>
           <span class="n">lattice_type</span><span class="o">=</span><span class="n">granad</span><span class="o">.</span><span class="n">LatticeType</span><span class="o">.</span><span class="n">HONEYCOMB</span><span class="p">,</span>
           <span class="n">lattice_constant</span><span class="o">=</span><span class="mf">2.46</span><span class="p">,</span>
          <span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference internal" href="#granad.Chain" title="granad.Chain"><em>Chain</em></a><em> | </em><a class="reference internal" href="#granad.Triangle" title="granad.Triangle"><em>Triangle</em></a><em> | </em><a class="reference internal" href="#granad.Hexagon" title="granad.Hexagon"><em>Hexagon</em></a><em> | </em><a class="reference internal" href="#granad.Rhomboid" title="granad.Rhomboid"><em>Rhomboid</em></a><em> | </em><a class="reference internal" href="#granad.Rectangle" title="granad.Rectangle"><em>Rectangle</em></a>) – a boolean array indicating the shape of the structure</p></li>
<li><p><strong>lattice_type</strong> (<a class="reference internal" href="#granad.LatticeType" title="granad.LatticeType"><em>LatticeType</em></a>) – lattice type</p></li>
<li><p><strong>lattice_edge</strong> (<a class="reference internal" href="#granad.LatticeEdge" title="granad.LatticeEdge"><em>LatticeEdge</em></a>) – edge type</p></li>
<li><p><strong>lattice_constant</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – lattice constant of the infinite lattice</p></li>
<li><p><strong>shift</strong> – spacial shift to apply to all coordinates</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.LatticeCoupling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">LatticeCoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_id2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_function=&lt;function</span> <span class="pre">LatticeCoupling.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.LatticeCoupling" title="Link to this definition">¶</a></dt>
<dd><p>Coupling in a lattice material.</p>
<p>Constructor accepts a lattice object and a list of couplings.
The i-th entry in the couplings-list determines the coupling to the i-th neighbor,
i.e. <code class="code docutils literal notranslate"><span class="pre">couplings[0]</span></code> is the onsite coupling, <code class="code docutils literal notranslate"><span class="pre">couplings[2]</span></code> is the NNN-coupling.</p>
<p>For example, the Coulomb coupling in spin-polarized graphene with an onsite strength
of <code class="code docutils literal notranslate"><span class="pre">16.522</span></code>, nearest-neighbor interaction of <code class="code docutils literal notranslate"><span class="pre">8.64</span></code>, next-to-nearest neighbor
interaction of <code class="code docutils literal notranslate"><span class="pre">5.333</span></code> and a classical coupling for orbitals further away can be modelled
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coulomb_graphene</span> <span class="o">=</span> <span class="n">LatticeCoupling</span><span class="p">(</span>
<span class="n">orbital_id1</span> <span class="o">=</span> <span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">orbital_id2</span> <span class="o">=</span> <span class="s2">&quot;pz&quot;</span><span class="p">,</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">graphene</span><span class="p">,</span>
<span class="n">couplings</span> <span class="o">=</span> <span class="p">[</span><span class="mf">16.522</span><span class="p">,</span> <span class="mf">8.64</span><span class="p">,</span> <span class="mf">5.333</span><span class="p">],</span>
<span class="n">coupling_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mf">14.399</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbital_id1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>orbital_id2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>lattice</strong> (<a class="reference internal" href="#granad.Lattice" title="granad.Lattice"><em>Lattice</em></a>) – lattice material</p></li>
<li><p><strong>couplings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – couplings</p></li>
<li><p><strong>coupling_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.12)"><em>complex</em></a><em>]</em>) – function to apply to all neighbours not covered by couplings</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.LatticeEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">LatticeEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.LatticeEdge" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.LatticeSpotCoupling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">LatticeSpotCoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spot_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_function=&lt;function</span> <span class="pre">LatticeSpotCoupling.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.LatticeSpotCoupling" title="Link to this definition">¶</a></dt>
<dd><p>Determines coupling between a lattice material and an isolated spot.</p>
<p>Constructor accepts a list of couplings.
The i-th entry in the couplings-list determines the coupling between the isolated spot
and its i-th neighbor in the lattice cut,
i.e. <code class="code docutils literal notranslate"><span class="pre">couplings[0]</span></code> is the onsite coupling, <code class="code docutils literal notranslate"><span class="pre">couplings[2]</span></code> is the NNN-coupling.</p>
<p>For example, the Coulomb coupling of a single adatom orbital by the string <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> to
a flake orbital identified by the string <code class="code docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code> with an onsite strength
of <code class="code docutils literal notranslate"><span class="pre">16.522</span></code>, nearest-neighbor interaction of <code class="code docutils literal notranslate"><span class="pre">8.64</span></code>, next-to-nearest neighbor
interaction of <code class="code docutils literal notranslate"><span class="pre">5.333</span></code> and a classical coupling for orbitals further away can be modelled
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coulomb_graphene</span> <span class="o">=</span> <span class="n">LatticeSpotCoupling</span><span class="p">(</span>
<span class="n">lattice_id</span> <span class="o">=</span> <span class="s2">&quot;pz&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">spot_id</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">couplings</span> <span class="o">=</span> <span class="p">[</span><span class="mf">16.522</span><span class="p">,</span> <span class="mf">8.64</span><span class="p">,</span> <span class="mf">5.333</span><span class="p">],</span>
<span class="n">coupling_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mf">14.399</span> <span class="o">/</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – bulk orbital id</p></li>
<li><p><strong>spot_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – isolated orbital id</p></li>
<li><p><strong>couplings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – couplings list</p></li>
<li><p><strong>coupling_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.12)"><em>complex</em></a><em>]</em>) – function to apply to all neighbours not covered by couplings</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.LatticeType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">LatticeType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.LatticeType" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Orbital">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Orbital</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Orbital" title="Link to this definition">¶</a></dt>
<dd><p>An orbital.
It is only used briefly during stack construction and immediately discarded after.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbital_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Orbital ID, e.g. “pz_graphene”.</p></li>
<li><p><strong>position</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Orbital position like <span class="math notranslate nohighlight">\((x,y,z)\)</span>, in Ångström.</p></li>
<li><p><strong>occupation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of electrons in the non-interacting orbital (<code class="code docutils literal notranslate"><span class="pre">1</span></code> or <code class="code docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><strong>sublattice_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Rectangle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Rectangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Rectangle" title="Link to this definition">¶</a></dt>
<dd><p>A rectangle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – side length in x-diretion</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – side length in y-diretion</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Rhomboid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Rhomboid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Rhomboid" title="Link to this definition">¶</a></dt>
<dd><p>A rhomboid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – side length in x-diretion</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – side length in y-diretion</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Spot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Spot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Spot" title="Link to this definition">¶</a></dt>
<dd><p>Single point in 3D space. Can represent isolated adatoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>position</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – point, e.g. <code class="code docutils literal notranslate"><span class="pre">[0.0,</span> <span class="pre">1.0,</span> <span class="pre">2.0]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.SpotCoupling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">SpotCoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_id2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.SpotCoupling" title="Link to this definition">¶</a></dt>
<dd><p>Onsite coupling. Can hold the coupling between two orbitals at an adatom.</p>
<p>For example, the onsite energy of a single adatom orbital identified by the string <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> can be modelled
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">onsite_adatom</span> <span class="o">=</span> <span class="n">SpotCoupling</span><span class="p">(</span>
<span class="n">orbital_id1</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="c1"># this id must match the id given to stack.add</span>
<span class="n">orbital_id2</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
<span class="n">coupling</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbital_id1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>orbital_id2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital id</p></li>
<li><p><strong>coupling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – coupling strength</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Stack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coulomb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_stat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electrons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Stack" title="Link to this definition">¶</a></dt>
<dd><p>A stack of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – TB-Hamiltonian of the system.</p></li>
<li><p><strong>coulomb</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Coulomb matrix of the system.</p></li>
<li><p><strong>rho_0</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Density matrix corresponding to the initial state. If a simulation is interrupted at time t, then it can be resumed using the density matrix at time t as rho_0.</p></li>
<li><p><strong>rho_stat</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Density matrix corresponding to the final state.</p></li>
<li><p><strong>energies</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Independent particle energies as given by the eigenvalues of the TB-hamiltonian.</p></li>
<li><p><strong>eigenvectors</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Eigenvectors of the TB-Hamiltonian. These are used to transform between <em>site</em> and <em>energy</em> basis.</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Positions of the orbitals, <span class="math notranslate nohighlight">\(N \times 3\)</span>-dimensional.</p></li>
<li><p><strong>unique_ids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – Collection of unique strings. Each string identifies an orbital type occuring in the stack. Typically something like “pz_graphene”.</p></li>
<li><p><strong>ids</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – The integer at the n-th position corresponds to the type of the n-th orbital via its index in unique_ids. For example, for unique_ids = [“A”, “B”], one has unique_ids[0] = “A”. Additionally, if ids[10] = 0, then the orbital at 10 is of type “A”. This is useful if you want to identify quantities corresponding to orbitals. So, say unique_ids = [“adatom_level1”, “adatom_level2”, “carbon”] and you want to know the position of the adatom. Then you can just perform the ugly lookup stack.positions[ jnp.argwhere(ids == stack.unique_ids.index(“adatom_level1”)), :]. This is what the function convenience-position function does.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – numerical precision threshold for identifiying degeneracies in the eigenenergies.</p></li>
<li><p><strong>homo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – index of the homo, such that stack.energies[homo] is the energy of the homo.</p></li>
<li><p><strong>electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – total number of electrons in the system.</p></li>
<li><p><strong>from_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the state from which electrons have been taken for the initial excited transition, the state translates to HOMO - from_state</p></li>
<li><p><strong>to_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the state into which electrons haven been put for the initial excited transition, the state translates to HOMO + from_state</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – corresponds to <span class="math notranslate nohighlight">\(\frac{1}{k_B T}\)</span></p></li>
<li><p><strong>sublattice_ids</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.StackBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">StackBuilder</span></span><a class="headerlink" href="#granad.StackBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Incremental specification of a composite nanomaterial.</p>
<p>Orbitals are added one by one and their TB-hopping and coulomb interactions specified.
Once the specification is finished,
the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">granad.numerics.StackBuilder.build_stack()</span></code> is to be called to produce a
<code class="xref py py-class docutils literal notranslate"><span class="pre">granad.numerics.StackBuilder.Stack</span></code> object for further use in numerical simulations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">material</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.add" title="Link to this definition">¶</a></dt>
<dd><p>Adds new orbitals to the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbital_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – new orbital to be added</p></li>
<li><p><strong>material</strong> (<a class="reference internal" href="#granad.Spot" title="granad.Spot"><em>Spot</em></a><em> | </em><a class="reference internal" href="#granad.Lattice" title="granad.Lattice"><em>Lattice</em></a>) – material, an isolated system or a lattice cut</p></li>
<li><p><strong>occupation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of electrons carried by the orbital</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.get_positions">
<span class="sig-name descname"><span class="pre">get_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbital_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.get_positions" title="Link to this definition">¶</a></dt>
<dd><p>Gets the positions in the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>orbital_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> | </em><em>None</em>) – If supplied, only get the positions of this orbital</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <span class="math notranslate nohighlight">\(N \times 3\)</span>-array, where <span class="math notranslate nohighlight">\(N\)</span> is the number of orbitals</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.get_stack">
<span class="sig-name descname"><span class="pre">get_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_func=&lt;function</span> <span class="pre">StackBuilder.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_state=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_state=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doping=0=inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps=1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.get_stack" title="Link to this definition">¶</a></dt>
<dd><p>Get stack object for numerical simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em>) – position-dependent additive term for hamiltonian (e.g. electric field)</p></li>
<li><p><strong>from_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, the state from which electrons to take for the initial excited transition, the state translates to HOMO - from_state</p></li>
<li><p><strong>to_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, the state into which electrons to put for the initial excited transition, the state translates to HOMO + from_state</p></li>
<li><p><strong>doping</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, how many doping electrons to throw into the stack</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – thermodynamic beta <span class="math notranslate nohighlight">\(\frac{1}{k_B T}\)</span></p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – optional, default 1e-5: numerical threshold. if two energies E1,E2 fullfill abs(E1-E2) &lt; eps, they are considered degenerate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>stack object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.set_coulomb">
<span class="sig-name descname"><span class="pre">set_coulomb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.set_coulomb" title="Link to this definition">¶</a></dt>
<dd><p>Specifies the Coulomb interaction between two types of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coulomb</strong> (<a class="reference internal" href="#granad.DistanceCoupling" title="granad.DistanceCoupling"><em>DistanceCoupling</em></a><em> | </em><a class="reference internal" href="#granad.SpotCoupling" title="granad.SpotCoupling"><em>SpotCoupling</em></a><em> | </em><a class="reference internal" href="#granad.LatticeCoupling" title="granad.LatticeCoupling"><em>LatticeCoupling</em></a><em> | </em><a class="reference internal" href="#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><em>LatticeSpotCoupling</em></a>) – coulomb coupling</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.set_hopping">
<span class="sig-name descname"><span class="pre">set_hopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hopping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.set_hopping" title="Link to this definition">¶</a></dt>
<dd><p>Specifies the TB-hopping between two types of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hopping</strong> (<a class="reference internal" href="#granad.DistanceCoupling" title="granad.DistanceCoupling"><em>DistanceCoupling</em></a><em> | </em><a class="reference internal" href="#granad.SpotCoupling" title="granad.SpotCoupling"><em>SpotCoupling</em></a><em> | </em><a class="reference internal" href="#granad.LatticeCoupling" title="granad.LatticeCoupling"><em>LatticeCoupling</em></a><em> | </em><a class="reference internal" href="#granad.LatticeSpotCoupling" title="granad.LatticeSpotCoupling"><em>LatticeSpotCoupling</em></a>) – hopping strength</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.show2D">
<span class="sig-name descname"><span class="pre">show2D</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.show2D" title="Link to this definition">¶</a></dt>
<dd><p>Plots all orbitals in 2D</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="granad.StackBuilder.show3D">
<span class="sig-name descname"><span class="pre">show3D</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#granad.StackBuilder.show3D" title="Link to this definition">¶</a></dt>
<dd><p>Plots all orbitals in 3D</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="granad.Triangle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">Triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.Triangle" title="Link to this definition">¶</a></dt>
<dd><p>An equilateral triangle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Base length of the triangle</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.absorption">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">absorption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coulomb_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.absorption" title="Link to this definition">¶</a></dt>
<dd><p>Calculates polarizability and absorption cross section in frequency domain. Uses SC equations based on non-interacting susceptibility
via the method given in <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/nn204780e">https://pubs.acs.org/doi/abs/10.1021/nn204780e</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>polarization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – component of the electric field to take (0,1,2) =&gt; (x,y,z)</p></li>
<li><p><strong>maximum_omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – maximum frequency</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – intrinsic relaxation time</p></li>
<li><p><strong>coulomb_strength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – coulomb strength scaling</p></li>
<li><p><strong>minimum_omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – minimum frequency</p></li>
<li><p><strong>discretization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of points in frequency grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple with first element being polarizability, second being absorption cross section</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.absorption_brute_force">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">absorption_brute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.absorption_brute_force" title="Link to this definition">¶</a></dt>
<dd><p>Calculates polarizability and absorption cross section via brute force. Uses SC equations based on non-interacting susceptibility
given in <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/nn204780e">https://pubs.acs.org/doi/abs/10.1021/nn204780e</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>rho</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – (equilibrium state) density matrix for which the field is to be computed</p></li>
<li><p><strong>omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – frequency at which the quantities should be computed</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – intrinsic relaxation time</p></li>
<li><p><strong>component</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – component of the electric field to take (0,1,2) =&gt; (x,y,z)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of (polarizability, absorption cross section)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.dipole_transitions">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">dipole_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transitions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_induced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.dipole_transitions" title="Link to this definition">¶</a></dt>
<dd><p>Takes into account dipole transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transitions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>]</em>) – dictionary mapping tuples containing two orbital strings to associated dipole transition, e.g. if there is a transition between “A” and “B” with a moment in z-direction, this would look like <code class="code docutils literal notranslate"><span class="pre">{(&quot;A&quot;,</span> <span class="pre">&quot;&quot;B)</span> <span class="pre">:</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1.0]}</span></code></p></li>
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – </p></li>
<li><p><strong>add_induced</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – add induced field to the field acting on the dipole</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transition function as additional input for evolution function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.electric_field">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">electric_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.electric_field" title="Link to this definition">¶</a></dt>
<dd><p>Function for computing time-harmonic electric fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitudes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – electric field amplitudes in xyz-components</p></li>
<li><p><strong>frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – frequency</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – position for evaluation</p></li>
<li><p><strong>k_vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JIT-compiled closure that computes the electric field as a functon of time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.electric_field_pulse">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">electric_field_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.electric_field_pulse" title="Link to this definition">¶</a></dt>
<dd><p>Function for computing temporally located time-harmonics electric fields. The pulse is implemented as a temporal Gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitudes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – electric field amplitudes in xyz-components</p></li>
<li><p><strong>frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – frequency of the electric field</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – positions where the electric field is evaluated</p></li>
<li><p><strong>peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – time where the pulse reaches its peak</p></li>
<li><p><strong>fwhm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – full width at half maximum</p></li>
<li><p><strong>k_vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JIT-compiled closure that computes the electric field as a functon of time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.electric_field_with_ramp_up">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">electric_field_with_ramp_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_ramp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.electric_field_with_ramp_up" title="Link to this definition">¶</a></dt>
<dd><p>Function for computing ramping up time-harmonic electric fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitudes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – electric field amplitudes in xyz-components</p></li>
<li><p><strong>frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – frequency</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – positions for evaluation</p></li>
<li><p><strong>ramp_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – specifies how long does the electric field ramps up</p></li>
<li><p><strong>time_ramp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – </p></li>
<li><p><strong>k_vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JIT-compiled closure that computes the electric field as a functon of time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.epi">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">epi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.epi" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the EPI (Energy-based plasmonicity index) of a mode at <span class="math notranslate nohighlight">\(\hbar\omega\)</span> in the absorption spectrum of a structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>rho</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – density matrix</p></li>
<li><p><strong>omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – energy at which the system has been CW-illuminated (<span class="math notranslate nohighlight">\(\hbar\omega\)</span> in eV)</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> | </em><em>None</em>) – small broadening parameter to ensure numerical stability, if <code class="code docutils literal notranslate"><span class="pre">None</span></code>, stack.eps is chosen</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>EPI, a number between <code class="code docutils literal notranslate"><span class="pre">0</span></code> (single-particle-like) and <code class="code docutils literal notranslate"><span class="pre">1</span></code> (plasmonic).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.evolution">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dissipation=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coulomb_strength=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.evolution" title="Link to this definition">¶</a></dt>
<dd><p>Propagate a stack forward in time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>time</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – time axis</p></li>
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em>) – electric field function</p></li>
<li><p><strong>dissipation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>] </em><em>| </em><em>None</em>) – dissipation function</p></li>
<li><p><strong>coulomb_strength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – scaling factor applied to coulomb interaction strength</p></li>
<li><p><strong>dipole_transition</strong> – a function describing dipolar transition radiation in the stack</p></li>
<li><p><strong>postprocess</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>] </em><em>| </em><em>None</em>) – a function applied to the density matrix after each time step</p></li>
<li><p><strong>transition</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(stack with rho_0 set to the current state, array containing all results from postprocess at all timesteps)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.get_self_consistent">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">get_self_consistent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.get_self_consistent" title="Link to this definition">¶</a></dt>
<dd><p>Get a stack with a self-consistent IP Hamiltonian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – a stack object</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – </p></li>
<li><p><strong>mix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – </p></li>
<li><p><strong>accuracy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a stack object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.indices">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.indices" title="Link to this definition">¶</a></dt>
<dd><p>Gets indices of a specific orbital.</p>
<p>Can be used to calculate, e.g. positions and energies corresponding to that orbital in the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>orbital_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – orbital identifier as contained in <code class="xref py py-class docutils literal notranslate"><span class="pre">granad.numerics.Stack.unique_ids</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>integer array corresponding to the indices of the orbitals, such that e.g. <code class="code docutils literal notranslate"><span class="pre">stack.energies[indices]</span></code> gives the energies associated with the orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.induced_dipole_moment">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">induced_dipole_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhos_diag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.induced_dipole_moment" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the induced dipole moment for a collection of density matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>rhos_diag</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – <span class="math notranslate nohighlight">\(N  imes m\)</span> time-dependent site occupation matrix, indexed by rhos_diag[timestep,site_number]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dipole_moments, <span class="math notranslate nohighlight">\(N  imes 3\)</span> matrix containing the induced dipole moment <span class="math notranslate nohighlight">\((p_x, p_y, p_z)\)</span> at <span class="math notranslate nohighlight">\(N\)</span> times</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.induced_field">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">induced_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.induced_field" title="Link to this definition">¶</a></dt>
<dd><p>Classical approximation to the induced (local) field in a stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – a stack object</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – positions to evaluate the field on, must be of shape N x 3</p></li>
<li><p><strong>density_matrix</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Density_matrix<span class="colon">:</span></dt>
<dd class="field-even"><p>if given, compute the field corresponding to this density matrix. otherwise, use <code class="code docutils literal notranslate"><span class="pre">stack.rho_0</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.relaxation">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">relaxation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.relaxation" title="Link to this definition">¶</a></dt>
<dd><p>Function for modelling dissipation according to the relaxation approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – relaxation time</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JIT-compiled closure that is needed for computing the dissipative part of the lindblad equation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_charge_distribution2D">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_charge_distribution2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_charge_distribution2D" title="Link to this definition">¶</a></dt>
<dd><p>Displays the ground state charge distribution of the stack in 2D</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – object representing system state</p></li>
<li><p><strong>plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – which plane to use for field evaluation. one of ‘xy’, ‘xz’, ‘yz’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_charge_distribution3D">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_charge_distribution3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_charge_distribution3D" title="Link to this definition">¶</a></dt>
<dd><p>Displays the ground state charge distribution of the stack in 3D</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_eigenstate2D">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_eigenstate2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicate_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_hilbert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_eigenstate2D" title="Link to this definition">¶</a></dt>
<dd><p>Shows a 2D scatter plot of how selected orbitals in a stack contribute to an eigenstate.
In the plot, orbitals are annotated with a color. The color corresponds either to the contribution to the selected eigenstate or to the type of the orbital.
Optionally, orbitals can be annotated with a number corresponding to the hilbert space index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – object representing system state</p></li>
<li><p><strong>plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – which plane to use for field evaluation. one of ‘xy’, ‘xz’, ‘yz’.</p></li>
<li><p><strong>show_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – eigenstate index to show. (0 =&gt; eigenstate with lowest energy)</p></li>
<li><p><strong>show_orbitals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – list of strings. orbitals to show. if None, all orbitals are shown.</p></li>
<li><p><strong>indicate_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, bigger points are orbitals contributing more strongly to the selected eigenstate.</p></li>
<li><p><strong>color_orbitals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, identical orbitals are colored identically and a legend is displayed listing all the different orbital types. if False, the color corresponds to the sublattice.</p></li>
<li><p><strong>annotate_hilbert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, the orbitals are annotated with a number corresponding to the hilbert space index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_eigenstate3D">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_eigenstate3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicate_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_hilbert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_eigenstate3D" title="Link to this definition">¶</a></dt>
<dd><p>Shows a 3D scatter plot of how selected orbitals in a stack contribute to an eigenstate.
In the plot, orbitals are annotated with a color. The color corresponds either to the contribution to the selected eigenstate or to the type of the orbital.
Optionally, orbitals can be annotated with a number corresponding to the hilbert space index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – object representing system state</p></li>
<li><p><strong>show_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – eigenstate index to show. (0 =&gt; eigenstate with lowest energy)</p></li>
<li><p><strong>show_orbitals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – orbitals to show. if None, all orbitals are shown.</p></li>
<li><p><strong>indicate_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, bigger points are orbitals contributing more strongly to the selected eigenstate.</p></li>
<li><p><strong>color_orbitals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, identical orbitals are colored identically and a legend is displayed listing all the different orbital types. if False, the color corresponds to the contribution to the sublattice.</p></li>
<li><p><strong>annotate_hilbert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if True, the orbitals are annotated with a number corresponding to the hilbert space index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_electric_field_space">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_electric_field_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_electric_field_space" title="Link to this definition">¶</a></dt>
<dd><p>Shows the external electric field on a spatial grid at a fixed point in time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – grid coordinates. get passed directly as meshgrid(frist, second).</p></li>
<li><p><strong>second</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – grid coordinates. get passed directly as meshgrid(frist, second).</p></li>
<li><p><strong>plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – which plane to use for field evaluation. one of ‘xy’, ‘xz’, ‘yz’. E.g. ‘xy’ means: make a plot in xy-plane and use “first”-parameter as x-axis, “second”-parameter as y-axis</p></li>
<li><p><strong>time</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – time to evalute the field at</p></li>
<li><p><strong>field_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em>) – a function taking in parameters as given by args and an additional argument “positions” that produces a closure that gives the electric field as function of time</p></li>
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – arguments to field_func as a dictionary, The “positions”-argument must be dropped.</p></li>
<li><p><strong>component</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0 =&gt; plot x, 1 =&gt; plot y, 2 =&gt; plot z</p></li>
<li><p><strong>flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0 =&gt; plot real, 1 =&gt; plot imag, 2 =&gt; plot abs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_electric_field_time">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_electric_field_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_electric_field_time" title="Link to this definition">¶</a></dt>
<dd><p>Shows the external electric field with its (x,y,z)-components as a function of time at a fixed spatial point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – array of points in time for field evaluation</p></li>
<li><p><strong>field</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – output of an electric field function</p></li>
<li><p><strong>flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0 =&gt; plot real, 1 =&gt; plot imag, 2 =&gt; plot abs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_energies">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_energies" title="Link to this definition">¶</a></dt>
<dd><p>Depicts the energy and occupation landscape of a stack (energies are plotted on the y-axis ordered by size)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_energy_occupations">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_energy_occupations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_energy_occupations" title="Link to this definition">¶</a></dt>
<dd><p>Depicts energy occupations as a function of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – a stack object</p></li>
<li><p><strong>occupations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a><em>]</em>) – list of energy occupations (complex arrays). The occupation at timestep n is given by <code class="code docutils literal notranslate"><span class="pre">occupations[n]</span></code>.</p></li>
<li><p><strong>time</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – time axis</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – plotting threshold. an occupation time series o_t is selected for plotting if it outgrows/outshrinks this bound. More exactly: o_t is plotted if max(o_t) - min(o_t) &gt; thresh</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.show_induced_field">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">show_induced_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electrons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.show_induced_field" title="Link to this definition">¶</a></dt>
<dd><p>Displays the normalized logarithm of the absolute value of the induced field in 2D</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – density matrix</p></li>
<li><p><strong>electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of electrons</p></li>
<li><p><strong>eigenvectors</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – eigenvectors of the corresponding stack (as stored in a stack object)</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – positions of the orbitals in the stack</p></li>
<li><p><strong>first</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – grid coordinates. get passed directly as meshgrid(frist, second).</p></li>
<li><p><strong>second</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – grid coordinates. get passed directly as meshgrid(frist, second).</p></li>
<li><p><strong>plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – which plane to use for field evaluation. one of ‘xy’, ‘xz’, ‘yz’. E.g. ‘xy’ means: make a plot in xy-plane and use “first”-parameter as x-axis, “second”-parameter as y-axis</p></li>
<li><p><strong>component</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0 =&gt; plot x, 1 =&gt; plot y, 2 =&gt; plot z</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – </p></li>
<li><p><strong>plot_stack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<p>:param norm : constant to normalize the field
:param plot_stack: if True, add a scatter plot indicating the positions of the orbitals in the stack</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.to_site_basis">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">to_site_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.to_site_basis" title="Link to this definition">¶</a></dt>
<dd><p>Transforms an arbitrary matrix from energy to site basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object</p></li>
<li><p><strong>matrix</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – square array in energy basis</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>square array in site basis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.transition_dipole_moments">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">transition_dipole_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.transition_dipole_moments" title="Link to this definition">¶</a></dt>
<dd><p>Compute transition dipole moments for all states <span class="math notranslate nohighlight">\(i,j\)</span> as <span class="math notranslate nohighlight">\(\braket{i | \hat{r} | j}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – stack object with N orbitals</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transition dipole moments as a complex <span class="math notranslate nohighlight">\(N \times N \times 3\)</span> - matrix, where the last component is the direction of the dipole moment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.transition_energies">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">transition_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.transition_energies" title="Link to this definition">¶</a></dt>
<dd><p>Computes independent-particle transition energies associated with the TB-Hamiltonian of a stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>square array, the element <code class="code docutils literal notranslate"><span class="pre">arr[i,j]</span></code> contains the transition energy from <code class="code docutils literal notranslate"><span class="pre">i</span></code> to <code class="code docutils literal notranslate"><span class="pre">j</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="granad.wigner_weisskopf">
<span class="sig-prename descclassname"><span class="pre">granad.</span></span><span class="sig-name descname"><span class="pre">wigner_weisskopf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#granad.wigner_weisskopf" title="Link to this definition">¶</a></dt>
<dd><p>Calculcates Wigner-Weisskopf transiton rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<a class="reference internal" href="#granad.Stack" title="granad.Stack"><em>Stack</em></a>) – </p></li>
<li><p><strong>component</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – component of the dipolar transition to take <span class="math notranslate nohighlight">\((0,1,2) \rightarrow (x,y,z)\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>square array, the element <code class="code docutils literal notranslate"><span class="pre">arr[i,j]</span></code> contains the transition rate from <code class="code docutils literal notranslate"><span class="pre">i</span></code> to <code class="code docutils literal notranslate"><span class="pre">j</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Reference</a><ul>
<li><a class="reference internal" href="#granad.Chain"><code class="docutils literal notranslate"><span class="pre">Chain</span></code></a></li>
<li><a class="reference internal" href="#granad.DistanceCoupling"><code class="docutils literal notranslate"><span class="pre">DistanceCoupling</span></code></a></li>
<li><a class="reference internal" href="#granad.Hexagon"><code class="docutils literal notranslate"><span class="pre">Hexagon</span></code></a></li>
<li><a class="reference internal" href="#granad.Lattice"><code class="docutils literal notranslate"><span class="pre">Lattice</span></code></a></li>
<li><a class="reference internal" href="#granad.LatticeCoupling"><code class="docutils literal notranslate"><span class="pre">LatticeCoupling</span></code></a></li>
<li><a class="reference internal" href="#granad.LatticeEdge"><code class="docutils literal notranslate"><span class="pre">LatticeEdge</span></code></a></li>
<li><a class="reference internal" href="#granad.LatticeSpotCoupling"><code class="docutils literal notranslate"><span class="pre">LatticeSpotCoupling</span></code></a></li>
<li><a class="reference internal" href="#granad.LatticeType"><code class="docutils literal notranslate"><span class="pre">LatticeType</span></code></a></li>
<li><a class="reference internal" href="#granad.Orbital"><code class="docutils literal notranslate"><span class="pre">Orbital</span></code></a></li>
<li><a class="reference internal" href="#granad.Rectangle"><code class="docutils literal notranslate"><span class="pre">Rectangle</span></code></a></li>
<li><a class="reference internal" href="#granad.Rhomboid"><code class="docutils literal notranslate"><span class="pre">Rhomboid</span></code></a></li>
<li><a class="reference internal" href="#granad.Spot"><code class="docutils literal notranslate"><span class="pre">Spot</span></code></a></li>
<li><a class="reference internal" href="#granad.SpotCoupling"><code class="docutils literal notranslate"><span class="pre">SpotCoupling</span></code></a></li>
<li><a class="reference internal" href="#granad.Stack"><code class="docutils literal notranslate"><span class="pre">Stack</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder"><code class="docutils literal notranslate"><span class="pre">StackBuilder</span></code></a><ul>
<li><a class="reference internal" href="#granad.StackBuilder.add"><code class="docutils literal notranslate"><span class="pre">StackBuilder.add()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.get_positions"><code class="docutils literal notranslate"><span class="pre">StackBuilder.get_positions()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.get_stack"><code class="docutils literal notranslate"><span class="pre">StackBuilder.get_stack()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.set_coulomb"><code class="docutils literal notranslate"><span class="pre">StackBuilder.set_coulomb()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.set_hopping"><code class="docutils literal notranslate"><span class="pre">StackBuilder.set_hopping()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.show2D"><code class="docutils literal notranslate"><span class="pre">StackBuilder.show2D()</span></code></a></li>
<li><a class="reference internal" href="#granad.StackBuilder.show3D"><code class="docutils literal notranslate"><span class="pre">StackBuilder.show3D()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#granad.Triangle"><code class="docutils literal notranslate"><span class="pre">Triangle</span></code></a></li>
<li><a class="reference internal" href="#granad.absorption"><code class="docutils literal notranslate"><span class="pre">absorption()</span></code></a></li>
<li><a class="reference internal" href="#granad.absorption_brute_force"><code class="docutils literal notranslate"><span class="pre">absorption_brute_force()</span></code></a></li>
<li><a class="reference internal" href="#granad.dipole_transitions"><code class="docutils literal notranslate"><span class="pre">dipole_transitions()</span></code></a></li>
<li><a class="reference internal" href="#granad.electric_field"><code class="docutils literal notranslate"><span class="pre">electric_field()</span></code></a></li>
<li><a class="reference internal" href="#granad.electric_field_pulse"><code class="docutils literal notranslate"><span class="pre">electric_field_pulse()</span></code></a></li>
<li><a class="reference internal" href="#granad.electric_field_with_ramp_up"><code class="docutils literal notranslate"><span class="pre">electric_field_with_ramp_up()</span></code></a></li>
<li><a class="reference internal" href="#granad.epi"><code class="docutils literal notranslate"><span class="pre">epi()</span></code></a></li>
<li><a class="reference internal" href="#granad.evolution"><code class="docutils literal notranslate"><span class="pre">evolution()</span></code></a></li>
<li><a class="reference internal" href="#granad.get_self_consistent"><code class="docutils literal notranslate"><span class="pre">get_self_consistent()</span></code></a></li>
<li><a class="reference internal" href="#granad.indices"><code class="docutils literal notranslate"><span class="pre">indices()</span></code></a></li>
<li><a class="reference internal" href="#granad.induced_dipole_moment"><code class="docutils literal notranslate"><span class="pre">induced_dipole_moment()</span></code></a></li>
<li><a class="reference internal" href="#granad.induced_field"><code class="docutils literal notranslate"><span class="pre">induced_field()</span></code></a></li>
<li><a class="reference internal" href="#granad.relaxation"><code class="docutils literal notranslate"><span class="pre">relaxation()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_charge_distribution2D"><code class="docutils literal notranslate"><span class="pre">show_charge_distribution2D()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_charge_distribution3D"><code class="docutils literal notranslate"><span class="pre">show_charge_distribution3D()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_eigenstate2D"><code class="docutils literal notranslate"><span class="pre">show_eigenstate2D()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_eigenstate3D"><code class="docutils literal notranslate"><span class="pre">show_eigenstate3D()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_electric_field_space"><code class="docutils literal notranslate"><span class="pre">show_electric_field_space()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_electric_field_time"><code class="docutils literal notranslate"><span class="pre">show_electric_field_time()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_energies"><code class="docutils literal notranslate"><span class="pre">show_energies()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_energy_occupations"><code class="docutils literal notranslate"><span class="pre">show_energy_occupations()</span></code></a></li>
<li><a class="reference internal" href="#granad.show_induced_field"><code class="docutils literal notranslate"><span class="pre">show_induced_field()</span></code></a></li>
<li><a class="reference internal" href="#granad.to_site_basis"><code class="docutils literal notranslate"><span class="pre">to_site_basis()</span></code></a></li>
<li><a class="reference internal" href="#granad.transition_dipole_moments"><code class="docutils literal notranslate"><span class="pre">transition_dipole_moments()</span></code></a></li>
<li><a class="reference internal" href="#granad.transition_energies"><code class="docutils literal notranslate"><span class="pre">transition_energies()</span></code></a></li>
<li><a class="reference internal" href="#granad.wigner_weisskopf"><code class="docutils literal notranslate"><span class="pre">wigner_weisskopf()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="units.html"
                          title="previous chapter">Units</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="about.html"
                          title="next chapter">About</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/granad.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="about.html" title="About"
             >next</a> |</li>
        <li class="right" >
          <a href="units.html" title="Units"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GRANAD  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, D.Dams, A.Ghosh, K.Słowik, J.Szczuczko.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>